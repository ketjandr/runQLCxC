<html>
<head>
<title>funding_analysis.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #808080;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
funding_analysis.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">matplotlib</span>
<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">import </span><span class="s1">matplotlib.pyplot </span><span class="s0">as </span><span class="s1">plt</span>
<span class="s0">import </span><span class="s1">seaborn </span><span class="s0">as </span><span class="s1">sns</span>
<span class="s0">import </span><span class="s1">nltk</span>
<span class="s0">from </span><span class="s1">nltk.metrics.distance </span><span class="s0">import </span><span class="s1">edit_distance</span>

<span class="s1">matplotlib.use(</span><span class="s2">&quot;TkAgg&quot;</span><span class="s1">)  </span><span class="s3"># Set the backend to TkAgg</span>

<span class="s3"># Define sector groups</span>
<span class="s1">sectorGroup = {</span>
    <span class="s2">'Technology and Software'</span><span class="s1">: [</span>
       <span class="s2">'SaaS'</span><span class="s0">, </span><span class="s2">'Quantum'</span><span class="s0">, </span><span class="s2">'Wearables'</span><span class="s0">, </span><span class="s2">'Robotics'</span><span class="s0">, </span><span class="s2">'Metaverse'</span><span class="s0">, </span><span class="s2">'ioT'</span><span class="s0">, </span><span class="s2">'Networks'</span><span class="s0">, </span><span class="s2">'blockchain'</span><span class="s0">, </span><span class="s2">'HRTech'</span><span class="s0">, </span><span class="s2">'AR'</span><span class="s0">, </span><span class="s2">'Electronics'</span><span class="s0">, </span><span class="s2">'BatteryTech'</span><span class="s0">,</span>
        <span class="s2">'3DTech'</span><span class="s0">, </span><span class="s2">'Platform'</span><span class="s0">, </span><span class="s2">'PaaS'</span><span class="s0">, </span><span class="s2">'DevTech'</span><span class="s0">, </span><span class="s2">'GeoTech'</span><span class="s0">, </span><span class="s2">'Hardware'</span><span class="s0">, </span><span class="s2">'Application Software'</span><span class="s0">, </span><span class="s2">'API'</span><span class="s0">, </span><span class="s2">'Enterprise Software'</span><span class="s0">,</span>
      <span class="s2">'HCI'</span><span class="s0">, </span><span class="s2">'VR'</span><span class="s0">, </span><span class="s2">'Biometrics'</span><span class="s0">, </span><span class="s2">'VisionTech'</span><span class="s0">, </span><span class="s2">'DisplayTech'</span><span class="s0">, </span><span class="s2">'NoCode'</span><span class="s0">,</span>
        <span class="s2">'3D Printing'</span><span class="s0">, </span><span class="s2">'Software Development'</span><span class="s0">, </span><span class="s2">'Computers and Electronics Manu'</span><span class="s0">, </span><span class="s2">'Desktop Computing Software Pro'</span><span class="s0">, </span><span class="s2">'Imaging'</span><span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Data and Information System'</span><span class="s1">: [</span>
       <span class="s2">'AI'</span><span class="s0">,  </span><span class="s2">'Analytics'</span><span class="s0">, </span><span class="s2">'Data'</span><span class="s0">, </span><span class="s2">'Cloud Computing'</span><span class="s0">, </span><span class="s2">'Machine Learning'</span><span class="s0">, </span><span class="s2">'Artificial Intelligences'</span><span class="s0">, </span><span class="s2">'information technology'</span><span class="s0">,</span>
        <span class="s2">'Email'</span><span class="s0">, </span><span class="s2">'GeoSpatial'</span><span class="s0">, </span><span class="s2">'data analysis'</span><span class="s0">, </span><span class="s2">'information technology , Trade'</span><span class="s0">, </span><span class="s2">'Technology, Information, Inter'</span><span class="s0">, </span><span class="s2">'Technology, Information and In'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Health and Biotech'</span><span class="s1">: [</span>
        <span class="s2">'BioTech'</span><span class="s0">, </span><span class="s2">'Pharmaceutical'</span><span class="s0">, </span><span class="s2">'Medical'</span><span class="s0">, </span><span class="s2">'Health Care Services'</span><span class="s0">, </span><span class="s2">'Electronic Health Record (EHR)'</span><span class="s0">, </span><span class="s2">'Health Diagnostics'</span><span class="s0">, </span><span class="s2">'Hospitals and Health Care'</span><span class="s0">,</span>
        <span class="s2">'MedTech'</span><span class="s0">, </span><span class="s2">'HealthTech'</span><span class="s0">, </span><span class="s2">'Pharmaceutical Manufacturing'</span><span class="s0">, </span><span class="s2">'Medical Device'</span><span class="s0">, </span><span class="s2">'Medical Equipment Manufacturin'</span><span class="s0">, </span><span class="s2">'Biotechnology Research'</span><span class="s0">,</span>
        <span class="s2">'Biotechnology'</span><span class="s0">, </span><span class="s2">'Womens Health'</span><span class="s0">, </span><span class="s2">'WellnessTech'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Finance, Business, and Marketing'</span><span class="s1">: [</span>
        <span class="s2">'FinTech'</span><span class="s0">, </span><span class="s2">'InsurTech'</span><span class="s0">, </span><span class="s2">'Cryptocurrency'</span><span class="s0">, </span><span class="s2">'B2B'</span><span class="s0">, </span><span class="s2">'Payments'</span><span class="s0">, </span><span class="s2">'Marketing'</span><span class="s0">, </span><span class="s2">'Recruiting'</span><span class="s0">, </span><span class="s2">'Career Planning'</span><span class="s0">, </span><span class="s2">'Billing'</span><span class="s0">, </span><span class="s2">'eCommerce'</span><span class="s0">, </span><span class="s2">'Marketplace'</span><span class="s0">, </span><span class="s2">'SalesTech'</span><span class="s0">, </span><span class="s2">'CRM'</span><span class="s0">, </span><span class="s2">'RetailTech'</span><span class="s0">, </span><span class="s2">'DeFi'</span><span class="s0">, </span><span class="s2">'ERP'</span><span class="s0">, </span><span class="s2">'financial services'</span><span class="s0">, </span><span class="s2">'insurance software'</span><span class="s0">, </span><span class="s2">'Retail'</span><span class="s0">, </span><span class="s2">'MarTech'</span><span class="s0">, </span><span class="s2">'Consumer'</span><span class="s0">, </span><span class="s2">'CrowdFunding'</span><span class="s0">, </span><span class="s2">'retail recyclable materials &amp;'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Environment and Agriculture'</span><span class="s1">: [</span>
        <span class="s2">'CleanTech'</span><span class="s0">, </span><span class="s2">'AgrTech'</span><span class="s0">, </span><span class="s2">'agTech'</span><span class="s0">, </span><span class="s2">'GreenTech'</span><span class="s0">, </span><span class="s2">'Environmental'</span><span class="s0">, </span><span class="s2">'Energy Efficiency'</span><span class="s0">, </span><span class="s2">'Renewable Energy'</span><span class="s0">, </span><span class="s2">'Mining Technology'</span><span class="s0">,</span>
        <span class="s2">'Environmental Services'</span><span class="s0">, </span><span class="s2">'Animal Feed Manufacturing'</span><span class="s0">, </span><span class="s2">'Chemical Raw Materials Manufac'</span><span class="s0">, </span><span class="s2">'ag-tech'</span><span class="s0">, </span><span class="s2">'FoodTech'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Media, Communications, and Entertainment'</span><span class="s1">: [</span>
        <span class="s2">'Media'</span><span class="s0">, </span><span class="s2">'eSports'</span><span class="s0">, </span><span class="s2">'Online Audio and Video Media'</span><span class="s0">, </span><span class="s2">'VideoTech'</span><span class="s0">, </span><span class="s2">'Mobile'</span><span class="s0">, </span><span class="s2">'AudioTech'</span><span class="s0">, </span><span class="s2">'Telecommunications'</span><span class="s0">, </span><span class="s2">'Communications Infrastructure'</span><span class="s0">, </span><span class="s2">'eLearning'</span><span class="s0">, </span><span class="s2">'Social'</span><span class="s0">, </span><span class="s2">'EntertainmentTech'</span><span class="s0">, </span><span class="s2">'SocialTech'</span><span class="s0">, </span><span class="s2">'Games'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Services and Security'</span><span class="s1">: [</span>
        <span class="s2">'Cybersecurity'</span><span class="s0">, </span><span class="s2">'Security and Investigations'</span><span class="s0">, </span><span class="s2">'GovTech'</span><span class="s0">, </span><span class="s2">'LegalTech'</span><span class="s0">, </span><span class="s2">'Consulting'</span><span class="s0">, </span><span class="s2">'R&amp;D'</span><span class="s0">, </span><span class="s2">'FitnessTech'</span><span class="s0">, </span><span class="s2">'EdTech'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Engineering, and Construction'</span><span class="s1">: [</span>
        <span class="s2">'Civil Engineering'</span><span class="s0">, </span><span class="s2">'ContructionTech'</span><span class="s0">, </span><span class="s2">'Construction Software'</span><span class="s0">, </span><span class="s2">'Automation Machinery Manufactu'</span><span class="s0">, </span><span class="s2">'Manufacturing'</span><span class="s0">,</span>
        <span class="s2">'Industrial Automation'</span><span class="s0">, </span><span class="s2">'Industrial Machinery Manufactu'</span><span class="s0">, </span><span class="s2">'Real Estate'</span><span class="s0">, </span><span class="s2">'Automotive'</span><span class="s0">, </span><span class="s2">'PropertyTech'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Travel and Logistics'</span><span class="s1">: [</span>
        <span class="s2">'LogisticsTech'</span><span class="s0">, </span><span class="s2">'TransportationTech'</span><span class="s0">, </span><span class="s2">'Last Mile Transportation'</span><span class="s0">, </span><span class="s2">'Maritime Transportation'</span><span class="s0">, </span><span class="s2">'Rail Transportation'</span><span class="s0">, </span><span class="s2">'AutoTech'</span><span class="s0">,</span>
        <span class="s2">'Logistics'</span><span class="s0">, </span><span class="s2">'TravelTech'</span><span class="s0">, </span><span class="s2">'Aerospace'</span><span class="s0">, </span><span class="s2">'SpaceTech'</span>
    <span class="s1">]</span><span class="s0">,</span>
    <span class="s2">'Others'</span><span class="s1">: [</span>
        <span class="s2">'Misc'</span><span class="s0">, </span><span class="s2">'NanoTech'</span><span class="s0">, </span><span class="s2">'AdTech'</span><span class="s0">, </span><span class="s2">'PetTech'</span><span class="s0">, </span><span class="s2">'SportsTech'</span><span class="s0">, </span><span class="s2">'Electrochromic'</span><span class="s0">, </span><span class="s2">'Esphera SynBio'</span>
    <span class="s1">]</span>
<span class="s1">}</span>

<span class="s3"># Convert sector group tags to lowercase</span>
<span class="s1">sectorGroup = {key: [tag.lower() </span><span class="s0">for </span><span class="s1">tag </span><span class="s0">in </span><span class="s1">value] </span><span class="s0">for </span><span class="s1">key</span><span class="s0">, </span><span class="s1">value </span><span class="s0">in </span><span class="s1">sectorGroup.items()}</span>


<span class="s0">def </span><span class="s1">assign_group(primary_tag):</span>
    <span class="s0">for </span><span class="s1">group</span><span class="s0">, </span><span class="s1">tags </span><span class="s0">in </span><span class="s1">sectorGroup.items():</span>
        <span class="s0">if </span><span class="s1">primary_tag </span><span class="s0">in </span><span class="s1">tags:</span>
            <span class="s0">return </span><span class="s1">group</span>
    <span class="s0">return </span><span class="s2">'Others'  </span><span class="s3"># Default group</span>


<span class="s0">def </span><span class="s1">analyze_funding_stages():</span>
    <span class="s3"># Load the dataset</span>
    <span class="s1">deals = pd.read_csv(</span><span class="s2">&quot;datasets/deals.csv&quot;</span><span class="s1">)</span>

    <span class="s3"># Clean and normalize sector names</span>
    <span class="s1">deals[</span><span class="s2">'primaryTag'</span><span class="s1">] = deals[</span><span class="s2">'primaryTag'</span><span class="s1">].astype(str).str.lower().str.strip()</span>

    <span class="s3"># Drop empty (NaN) tags to avoid errors</span>
    <span class="s1">deals = deals[deals[</span><span class="s2">'primaryTag'</span><span class="s1">].notna()]</span>

    <span class="s3"># Fuzzy matching for similar tags</span>
    <span class="s1">unique_tags = deals[</span><span class="s2">'primaryTag'</span><span class="s1">].dropna().unique()</span>
    <span class="s1">tag_mapping = {}</span>

    <span class="s0">for </span><span class="s1">i</span><span class="s0">, </span><span class="s1">tag1 </span><span class="s0">in </span><span class="s1">enumerate(unique_tags):</span>
        <span class="s0">if </span><span class="s1">pd.isna(tag1):  </span><span class="s3"># Skip NaN values</span>
            <span class="s0">continue</span>

        <span class="s1">tag1 = str(tag1)  </span><span class="s3"># Ensure tag1 is a string</span>
        <span class="s0">if </span><span class="s1">tag1 </span><span class="s0">in </span><span class="s1">tag_mapping:</span>
            <span class="s0">continue  </span><span class="s3"># Skip already mapped tags</span>

        <span class="s1">tag_mapping[tag1] = tag1  </span><span class="s3"># Initialize mapping with itself</span>
        <span class="s0">for </span><span class="s1">tag2 </span><span class="s0">in </span><span class="s1">unique_tags[i + </span><span class="s4">1</span><span class="s1">:]:</span>
            <span class="s0">if </span><span class="s1">pd.isna(tag2):  </span><span class="s3"># Skip NaN values</span>
                <span class="s0">continue</span>

            <span class="s1">tag2 = str(tag2)  </span><span class="s3"># Ensure tag2 is a string</span>
            <span class="s0">if </span><span class="s1">tag2 </span><span class="s0">not in </span><span class="s1">tag_mapping:  </span><span class="s3"># Check if the tag has been assigned</span>
                <span class="s0">if </span><span class="s1">(edit_distance(tag1</span><span class="s0">, </span><span class="s1">tag2) &lt;= </span><span class="s4">2 </span><span class="s0">and </span><span class="s1">len(tag1) &gt;= </span><span class="s4">10</span><span class="s1">) </span><span class="s0">or </span><span class="s1">(</span>
                        <span class="s1">edit_distance(tag1</span><span class="s0">, </span><span class="s1">tag2) &lt;= </span><span class="s4">1 </span><span class="s0">and </span><span class="s1">len(tag1) &gt;= </span><span class="s4">8</span><span class="s1">):</span>
                    <span class="s1">tag_mapping[tag2] = tag1  </span><span class="s3"># Assign similar tag</span>

    <span class="s3"># Apply mapping</span>
    <span class="s1">deals[</span><span class="s2">'primaryTag'</span><span class="s1">] = deals[</span><span class="s2">'primaryTag'</span><span class="s1">].map(tag_mapping)</span>

    <span class="s3"># Assign sector groups</span>
    <span class="s1">deals[</span><span class="s2">'sectorGroup'</span><span class="s1">] = deals[</span><span class="s2">'primaryTag'</span><span class="s1">].apply(assign_group)</span>

    <span class="s3"># Filter out missing values</span>
    <span class="s1">deals = deals[[</span><span class="s2">'roundType'</span><span class="s0">, </span><span class="s2">'amount'</span><span class="s0">, </span><span class="s2">'sectorGroup'</span><span class="s1">]].dropna()</span>

    <span class="s3"># Convert 'amount' column to numeric, handling errors</span>
    <span class="s1">deals[</span><span class="s2">'amount'</span><span class="s1">] = pd.to_numeric(deals[</span><span class="s2">'amount'</span><span class="s1">]</span><span class="s0">, </span><span class="s1">errors=</span><span class="s2">'coerce'</span><span class="s1">)</span>

    <span class="s3"># Aggregate: Total number of deals &amp; total funding volume per sector and stage</span>
    <span class="s1">funding_summary = deals.groupby([</span><span class="s2">'sectorGroup'</span><span class="s0">, </span><span class="s2">'roundType'</span><span class="s1">]).agg(</span>
        <span class="s1">total_deals=(</span><span class="s2">'amount'</span><span class="s0">, </span><span class="s2">'count'</span><span class="s1">)</span><span class="s0">,  </span><span class="s3"># Number of deals</span>
        <span class="s1">total_funding=(</span><span class="s2">'amount'</span><span class="s0">, </span><span class="s2">'sum'</span><span class="s1">)  </span><span class="s3"># Total funding amount</span>
    <span class="s1">).reset_index()</span>

    <span class="s3"># Pivot data for plotting</span>
    <span class="s1">pivot_deals = funding_summary.pivot(index=</span><span class="s2">'sectorGroup'</span><span class="s0">, </span><span class="s1">columns=</span><span class="s2">'roundType'</span><span class="s0">, </span><span class="s1">values=</span><span class="s2">'total_deals'</span><span class="s1">).fillna(</span><span class="s4">0</span><span class="s1">)</span>

    <span class="s3"># Plot</span>
    <span class="s1">pivot_deals.plot(kind=</span><span class="s2">'bar'</span><span class="s0">, </span><span class="s1">stacked=</span><span class="s0">True, </span><span class="s1">figsize=(</span><span class="s4">14</span><span class="s0">, </span><span class="s4">10</span><span class="s1">)</span><span class="s0">, </span><span class="s1">colormap=</span><span class="s2">&quot;viridis&quot;</span><span class="s1">)</span>
    <span class="s1">plt.title(</span><span class="s2">&quot;Number of Deals per Sector Group by Funding Stage&quot;</span><span class="s1">)</span>
    <span class="s1">plt.xlabel(</span><span class="s2">&quot;Sector Groups&quot;</span><span class="s1">)</span>
    <span class="s1">plt.ylabel(</span><span class="s2">&quot;Number of Deals&quot;</span><span class="s1">)</span>
    <span class="s1">plt.legend(title=</span><span class="s2">&quot;Funding Stage&quot;</span><span class="s0">, </span><span class="s1">bbox_to_anchor=(</span><span class="s4">1.05</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span><span class="s0">, </span><span class="s1">loc=</span><span class="s2">'upper left'</span><span class="s1">)</span>
    <span class="s1">plt.xticks(rotation=</span><span class="s4">90</span><span class="s0">, </span><span class="s1">fontsize=</span><span class="s4">7</span><span class="s1">)</span>
    <span class="s1">plt.subplots_adjust(bottom=</span><span class="s4">0.3</span><span class="s0">, </span><span class="s1">right=</span><span class="s4">0.8</span><span class="s1">)  </span><span class="s3"># Adjust layout</span>
    <span class="s1">plt.show()</span>


<span class="s3"># Run only if executed directly</span>
<span class="s0">if </span><span class="s1">__name__ == </span><span class="s2">&quot;__main__&quot;</span><span class="s1">:</span>
    <span class="s1">analyze_funding_stages()</span>
</pre>
</body>
</html>